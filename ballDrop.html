<!doctype html>
<html>

<head>
  <title>Ball Drop</title>
  <style>
    * {
      margin: 0;
      overflow: hidden;
    }
  </style>

</head>

<body>
  <canvas id="canv"></canvas>

  <script src="./engine/Vector2.js"></script>
  <script src="./engine/Scene.js"></script>
  <script src="./engine/GameObject.js"></script>
  <script src="./engine/Component.js"></script>
  <script src="./engine/Input.js"></script>
  <script src="./engine/Engine.js"></script>
  <script src="./engine/Collisions.js"></script>
  <script src="./engine/Time.js"></script>
  <script src="./engine/Assets.js"></script>

  <script src="./engine/components/Transform.js"></script>
  <script src="./engine/components/Polygon.js"></script>
  <script src="./engine/components/Collider.js"></script>
  <script src="./engine/components/Text.js"></script>
  <script src="./engine/components/RigidBody.js"></script>

  <script>

    class MainScene extends Scene {
      constructor() {
        super()
        this.instantiate(new BallGameObject(), new Vector2(100, 20))
      }
    }

    class BallGameObject extends GameObject {
      constructor() {
        super("Ball Game Object")
        this.addComponent(new Polygon(), { points: Assets.circlePoints, fillStyle: "black" })
        this.addComponent(new BallController())
        this.addComponent(new RigidBody())
        this.transform.scale = new Vector2(20, 20)
      }
    }

    function lerp(a, b, p){
      return (1-p)*a+p*b
    }

    class BallController extends Component {
      start(){
        this.rigidBody = this.gameObject.getComponent(RigidBody)
        this.rigidBody.gravity.y = 32
      }
      update() {
        if(this.transform.position.y > 400){
          this.rigidBody.velocity.y *= -.5
          this.transform.scale.y = 10
          this.transform.scale.x = 30
        }
        this.transform.scale.x = lerp(this.transform.scale.x, 20, .1)
        this.transform.scale.y = lerp(this.transform.scale.y, 20, .1)
      }
    }

    





    Engine.currentScene = new MainScene()
    Engine.start()

  </script>
</body>

</html>